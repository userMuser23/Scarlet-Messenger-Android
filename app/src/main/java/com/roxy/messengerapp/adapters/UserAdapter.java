package com.roxy.messengerapp.adapters;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.TextView;import androidx.annotation.NonNull;import androidx.recyclerview.widget.RecyclerView;import com.bumptech.glide.Glide;import com.google.firebase.auth.FirebaseAuth;import com.google.firebase.auth.FirebaseUser;import com.google.firebase.database.DataSnapshot;import com.google.firebase.database.DatabaseError;import com.google.firebase.database.DatabaseReference;import com.google.firebase.database.FirebaseDatabase;import com.google.firebase.database.ValueEventListener;import com.roxy.messengerapp.R;import com.roxy.messengerapp.entities.Chat;import com.roxy.messengerapp.entities.User; // Твоя модельimport java.util.List;import de.hdodenhof.circleimageview.CircleImageView;public class UserAdapter extends RecyclerView.Adapter<UserAdapter.ViewHolder> {    private List<User> mUsers;    private OnUserClickListener onUserClickListener;    private boolean isChat;    String theLastMessage;    public interface OnUserClickListener {        void onUserClick(User user);    }    public UserAdapter(List<User> mUsers, OnUserClickListener listener, boolean isChat) {        this.mUsers = mUsers;        this.onUserClickListener = listener;        this.isChat = isChat;    }    @NonNull    @Override    public ViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {        View view = LayoutInflater.from(parent.getContext()).inflate(R.layout.user_item, parent, false);        return new ViewHolder(view);    }    @Override    public void onBindViewHolder(@NonNull ViewHolder holder, int position) {        User user = mUsers.get(position);        holder.username.setText(user.getUsername());        if (user.getImageURL().equals("default")) {            holder.profile_image.setImageResource(R.mipmap.ic_launcher);        } else {            Glide.with(holder.itemView.getContext()).load(user.getImageURL()).into(holder.profile_image);        }        String currentStatus = (user.getStatus() == null) ? "offline" : user.getStatus();        if (isChat) {            // 1. Последнее сообщение (твоя существующая логика)            lastMessage(user.getId(), holder.last_msg);            holder.last_msg.setVisibility(View.VISIBLE);            // 2. Статус Онлайна (добавляем сюда)            if (currentStatus.equals("online")) {                holder.img_on.setVisibility(View.VISIBLE);                holder.img_off.setVisibility(View.GONE);            } else {                holder.img_on.setVisibility(View.GONE);                holder.img_off.setVisibility(View.VISIBLE);            }        } else {            // Если это вкладка "Все пользователи", скрываем и сообщение, и индикаторы            holder.last_msg.setVisibility(View.GONE);            holder.img_on.setVisibility(View.GONE);            holder.img_off.setVisibility(View.GONE);        }        holder.itemView.setOnClickListener(v -> onUserClickListener.onUserClick(user));    }    @Override    public int getItemCount() {        return mUsers.size();    }    public static class ViewHolder extends RecyclerView.ViewHolder {        public TextView username;        public CircleImageView profile_image;        public TextView last_msg;        public View img_on;        public View img_off;        public ViewHolder(View itemView) {            super(itemView);            username = itemView.findViewById(R.id.tvUserName); // Проверь ID из user_item.xml            profile_image = itemView.findViewById(R.id.ivUserAvatar);            last_msg = itemView.findViewById(R.id.last_msg);            img_on = itemView.findViewById(R.id.img_on);            img_off = itemView.findViewById(R.id.img_off);        }    }    private void lastMessage(final String userid, final TextView last_msg) {        theLastMessage = "default";        final FirebaseUser firebaseUser = FirebaseAuth.getInstance().getCurrentUser();        DatabaseReference reference = FirebaseDatabase.getInstance().getReference("Chats");        reference.addValueEventListener(new ValueEventListener() {            @Override            public void onDataChange(@NonNull DataSnapshot dataSnapshot) {                for (DataSnapshot snapshot : dataSnapshot.getChildren()) {                    Chat chat = snapshot.getValue(Chat.class);                    if (firebaseUser != null && chat != null) {                        // Проверяем переписку между мной и этим юзером                        if (chat.getReceiver().equals(firebaseUser.getUid()) && chat.getSender().equals(userid) ||                                chat.getReceiver().equals(userid) && chat.getSender().equals(firebaseUser.getUid())) {                            theLastMessage = chat.getMessage();                        }                    }                }                switch (theLastMessage) {                    case "default":                        last_msg.setText("No Message");                        break;                    default:                        last_msg.setText(theLastMessage);                        break;                }                theLastMessage = "default";            }            @Override            public void onCancelled(@NonNull DatabaseError databaseError) {            }        });    }}